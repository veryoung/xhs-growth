import{genCapaPostDeeplink as s}from"./core/task/publishNotes/capa.js";import{InviteFriendsTask as t}from"./core/task/inviteFriends/index.js";import{httpConfig as e}from"./config/http.config.js";import{createEnvironment as i}from"./env/index.js";class a{publish(t){const e=s({attach:{topics:(i=t,i.split(",").filter((s=>""!==s.trim())).map((s=>({page_id:s.trim()}))))},config:{is_post_jump:0}});var i;return go(e,{type:"deeplink",fail:s=>{}}),1}}class n{viewTopic(s,t){go(`https://www.xiaohongshu.com/page/topics/${s}?fullscreen=true&naviHidden=yes`,{type:"url",success:s=>{},fail:s=>{},complete:s=>{}});const e=""+new URLSearchParams({activityId:"xyxiaomaibu",taskId:"3124",taskType:"TOPIC_NOTE_BROWSE",...(null==t?void 0:t.times)&&{times:""+t.times},...(null==t?void 0:t.source)&&{source:t.source},...(null==t?void 0:t.asc)&&{asc:""+t.asc},...(null==t?void 0:t.totalSize)&&{totalSize:""+t.totalSize}});go("https://yingzheng.xiaohongshu.com/overview?"+e,{type:"url"})}}class r{constructor(){this.follow=new p,this.publishNotes=new a,this.inviteFriends=new t,this.topic=new n}async getTaskList(){return await fetch("GET",e.API_LIST.taskTable)}async claimTask(s){return await fetch("POST",e.API_LIST.claimTask,{taskMetaId:s})}async completeTask(s,t,i){return await fetch("POST",e.API_LIST.completeTask,{instanceId:s,eventType:t,params:i})}async polling(s){const t=s?`${e.API_LIST.polling}?group=${s}`:e.API_LIST.polling;return await fetch("POST",t)}async queryRecord(s){const t=`${e.API_LIST.qureyRecord}?limit=${s}`;return await fetch("GET",t)}}class Core{constructor(){this.isDebugger=!1,this.activityId="",this.task=new r}async init(s){return this.config=s,this.activityId=s.activityId,this.env=i(s.platform,{fetchCore:s.fetchCore,isDebugger:s.isDebugger,activityId:s.activityId,baseUrl:s.baseUrl}),await this.env.init(),this}go(s,t){return this.env.go(s,t)}fetch(s,t,e,i){return this.env.fetch(s,t,e,i)}getUserType(){return this.env.getUserType()}}let o;const c=()=>(o||(o=new Core),o),go=(s,t)=>c().go(s,t),fetch=(s,t,e,i)=>c().fetch(s,t,e,i),getUserType=()=>c().getUserType();var l=c();class p{takeFollow(s){go("xhsdiscover://user/"+s,{type:"deeplink",success:s=>{},fail:s=>{},complete:s=>{}})}cancelFollow(){}}export{Core as C,p as F,a as P,n as T,r as a,getUserType as b,fetch as f,go as g,l as i};